<!DOCTYPE html>
<html lang="en-US" dir="ltr">
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="robots" content="noindex, nofollow">
</head>
<body class="ignore-math">
<article class="exercise exercise-like"><h4 class="heading">
<span class="type">-</span><span class="space"> </span><span class="codenumber">10.4</span><span class="period">.</span><span class="space"> </span><span class="title">The fundamental theorem of calculus.</span>
</h4>
<article class="task exercise-like"><h5 class="heading"><span class="codenumber">(a)</span></h5>State and prove the "derivative of integral" version of the fundamental theorem of calculus.<div class="solutions"><details class="solution solution-like"><summary><span class="type">Solution</span><span class="period">.</span></summary><div class="solution solution-like">
<article class="theorem theorem-like"><h6 class="heading">
<span class="type">Theorem</span><span class="space"> </span><span class="codenumber">10.5</span><span class="period">.</span><span class="space"> </span><span class="title">Fundamental theorem of calculus - derivative of integral.</span>
</h6>Let <span class="process-math">\(a, b \in \R\)</span> with <span class="process-math">\(a \lt  b\text{.}\)</span> Let <span class="process-math">\(f : [a,b] \to \R\)</span> be Riemann integrable. Define the function <span class="process-math">\(F : [a,b] \to \R\)</span> at <span class="process-math">\(x \in [a,b]\)</span> by<a class="xref" id="fn-15" href="" data-knowl="./knowl/fn-15.html" title="Footnote 10.1"><sup> 1 </sup></a><div class="displaymath process-math">
\begin{equation*}
F(x) := \int_a^x f.
\end{equation*}
</div>Then <span class="process-math">\(F\)</span> is continuous on <span class="process-math">\([a,b]\)</span> Moreover, if <span class="process-math">\(f\)</span> is continuous at <span class="process-math">\(x_0 \in (a,b)\)</span> then <span class="process-math">\(F\)</span> is differentiable at <span class="process-math">\(x_0\)</span> and we have<div class="displaymath process-math">
\begin{equation*}
F'(x_0) = f(x_0).
\end{equation*}
</div></article><details class="hiddenproof"><summary><h6 class="heading"><span class="type">Proof<span class="period">.</span></span></h6></summary><article class="hiddenproof">For <span class="process-math">\(x,y \in [a,b]\)</span> with <span class="process-math">\(x \lt  y\text{,}\)</span> the interval additivity property (<code class="code-inline tex2jax_ignore">[cross-reference to target(s) "prop-int-subinterval" missing or not unique]</code>) gives that<div class="displaymath process-math" data-contains-math-knowls=" ./knowl/cor-up-low-finite.html  ./knowl/prop-sandwich.html ./knowl/thm-int-add.html  ./knowl/def-differentiable.html">
\begin{equation*}
\abs{\int_a^x f - \int_a^{y} f} = \abs{\int_x^y f}.
\end{equation*}
</div>By the trivial upper bound for the integral (<a href="" class="xref" data-knowl="./knowl/cor-up-low-finite.html" title="Equation 9.1">(9.1)</a>) and the integral triangle inequality (<code class="code-inline tex2jax_ignore">[cross-reference to target(s) "prop-int-ineq" missing or not unique]</code>) we have<div class="displaymath process-math" data-contains-math-knowls=" ./knowl/cor-up-low-finite.html  ./knowl/prop-sandwich.html ./knowl/thm-int-add.html  ./knowl/def-differentiable.html">
\begin{equation*}
\abs{\int_x^y f} \leq \int_x^y \abs{f} \leq (y-x)\sup_{[x,y]} |f|.
\end{equation*}
</div>It follows that for <span class="process-math">\(x, x_0 \in [a,b]\)</span> we have<div class="displaymath process-math" data-contains-math-knowls=" ./knowl/cor-up-low-finite.html  ./knowl/prop-sandwich.html ./knowl/thm-int-add.html  ./knowl/def-differentiable.html">
\begin{equation*}
|F(x)-F(x_0)| \leq \abs{x-x_0} \sup_{[a,b]} |f|.
\end{equation*}
</div>Since <span class="process-math">\(\sup_{[a,b]} |f| \lt  \infty\text{,}\)</span> the sandwich rule (<a href="" class="xref" data-knowl="./knowl/prop-sandwich.html" title="Proposition 2.10: Sandwich rule">Proposition 2.10</a>) gives that<div class="displaymath process-math" data-contains-math-knowls=" ./knowl/cor-up-low-finite.html  ./knowl/prop-sandwich.html ./knowl/thm-int-add.html  ./knowl/def-differentiable.html">
\begin{equation*}
|F(x)-F(x_0)| \to 0 \quad \text{as}\quad   x \to x_0 \quad \text{through} \quad [a,b].
\end{equation*}
</div>Thus <span class="process-math">\(F\)</span> is continuous at <span class="process-math">\(x_0\text{.}\)</span> Next, suppose that <span class="process-math">\(f \)</span> is continuous at <span class="process-math">\(x_0 \in (a,b)\text{.}\)</span> Letting <span class="process-math">\(\eps \gt 0\text{,}\)</span> there exists <span class="process-math">\(\delta = \delta(\eps) \gt 0\)</span> such that if <span class="process-math">\(x \in [a,b]\)</span> and <span class="process-math">\(|x-x_0| \leq \delta\)</span> then <span class="process-math">\(|f(x)-f(x_0)| \leq \eps\text{.}\)</span> Notice that for <span class="process-math">\(h \gt0\)</span> we have<div class="displaymath process-math" data-contains-math-knowls=" ./knowl/cor-up-low-finite.html  ./knowl/prop-sandwich.html ./knowl/thm-int-add.html  ./knowl/def-differentiable.html">
\begin{equation*}
h^{-1} \int_{x_0}^{x_0+h} f(x_0) \intd x = f(x_0)h^{-1} \int_{x_0}^{x_0+h} 1 = f(x_0).
\end{equation*}
</div>It follows that if <span class="process-math">\(0 \lt  h \leq \delta\)</span> then by linearity of integration (<a href="" class="xref" data-knowl="./knowl/thm-int-add.html" title="Theorem 9.13: Linearity of integration">Theorem 9.13</a>) and the integral triangle inequality (<code class="code-inline tex2jax_ignore">[cross-reference to target(s) "prop-int-ineq" missing or not unique]</code>) we have<div class="displaymath process-math" data-contains-math-knowls=" ./knowl/cor-up-low-finite.html  ./knowl/prop-sandwich.html ./knowl/thm-int-add.html  ./knowl/def-differentiable.html">
\begin{align*}
\abs{\frac{\int_a^{x_0+h} f - \int_a^{x_0}f}{h} - f(x_0)}\amp \leq h^{-1}\int_{x_0}^{x_0+h} \abs{f(x)-f(x_0)}\intd x \\
\amp \leq h^{-1}\int_{x_0}^{x_0+h}\eps  = \eps.
\end{align*}
</div>Hence for <span class="process-math">\(0 \lt  h \leq \delta\)</span> we have<div class="displaymath process-math" data-contains-math-knowls=" ./knowl/cor-up-low-finite.html  ./knowl/prop-sandwich.html ./knowl/thm-int-add.html  ./knowl/def-differentiable.html">
\begin{equation*}
\abs{\frac{F(x_0 + h)-F(x_0)}{h} - f(x_0)} \leq \eps.
\end{equation*}
</div>A similar argument proves the same inequality when <span class="process-math">\(-\delta \lt  h \lt  0\text{.}\)</span> It follows from the definition of differentiability (<a href="" class="xref" data-knowl="./knowl/def-differentiable.html" title="Definition 7.2: Differentiable">Definition 7.2</a>) that <span class="process-math">\(F'(x_0) = f(x_0)\text{.}\)</span></article></details>
</div></details></div></article><article class="task exercise-like"><h5 class="heading"><span class="codenumber">(b)</span></h5>State and prove the "integral of derivative" version of the fundamental theorem of calculus.<div class="solutions"><details class="solution solution-like"><summary><span class="type">Solution</span><span class="period">.</span></summary><div class="solution solution-like">
<article class="theorem theorem-like"><h6 class="heading">
<span class="type">Theorem</span><span class="space"> </span><span class="codenumber">10.6</span><span class="period">.</span><span class="space"> </span><span class="title">Fundamental theorem of calculus - integral of derivative.</span>
</h6>Let <span class="process-math">\(f : (a,b) \to \R\text{.}\)</span> Suppose that <span class="process-math">\(f\)</span> is differentiable on <span class="process-math">\((a,b)\text{.}\)</span> Given <span class="process-math">\(x,y \in (a,b)\)</span> with <span class="process-math">\(x \lt  y\text{,}\)</span> suppose that <span class="process-math">\(f'\)</span> is Riemann integrable on <span class="process-math">\([x,y]\text{.}\)</span> Then<div class="displaymath process-math">
\begin{equation*}
\int_x^y f' = f(y) - f(x). 
\end{equation*}
</div></article><details class="hiddenproof"><summary><h6 class="heading"><span class="type">Proof<span class="period">.</span></span></h6></summary><article class="hiddenproof">Let <span class="process-math">\(x = x_0 \lt  \dots \lt  x_N = y\)</span> denote a subdivision of <span class="process-math">\([x,y]\text{.}\)</span> For each <span class="process-math">\(n\text{,}\)</span> the mean value theorem (<a href="" class="xref" data-knowl="./knowl/thm-mvt.html" title="Theorem 8.7: Mean value theorem">Theorem 8.7</a>) gives <span class="process-math">\(y_n \in (x_{n-1}, x_n)\)</span> such that<div class="displaymath process-math" data-contains-math-knowls="./knowl/thm-mvt.html ./knowl/def-up-low-riemann-integral.html">
\begin{equation*}
f(x_n) - f(x_{n-1})  = f'(y_n)(x_n-x_{n-1}).
\end{equation*}
</div>Hence<div class="displaymath process-math" data-contains-math-knowls="./knowl/thm-mvt.html ./knowl/def-up-low-riemann-integral.html">
\begin{equation*}
f(y) - f(x) = \sum_{n=1}^N \sqbrac{f(x_n)-f(x_{n-1})} = \sum_{n=1}^N (x_n-x_{n-1})f'(y_n).
\end{equation*}
</div>Thus<div class="displaymath process-math" data-contains-math-knowls="./knowl/thm-mvt.html ./knowl/def-up-low-riemann-integral.html">
\begin{equation*}
L(f';x_0, \dots, x_N) \leq f(y)-f(x) \leq U(f';x_0, \dots, x_N).
\end{equation*}
</div>Since this holds for all subdivisions <span class="process-math">\(x = x_0 \lt  \dots \lt  x_N = y\text{,}\)</span> it follows from the definition of the upper and lower Riemann integrals (<a href="" class="xref" data-knowl="./knowl/def-up-low-riemann-integral.html" title="Definition 9.4: Upper/lower Riemann integral">Definition 9.4</a>) that<div class="displaymath process-math" data-contains-math-knowls="./knowl/thm-mvt.html ./knowl/def-up-low-riemann-integral.html">
\begin{equation*}
L(f'; [a,b]) \leq f(y)-f(x) \leq U(f';[a,b]).
\end{equation*}
</div>Since <span class="process-math">\(f'\)</span> is Riemann integrable on <span class="process-math">\([x,y]\text{,}\)</span> we have <span class="process-math">\(L(f';[x,y]) = U(f';[x,y]) = \int_x^y f'\text{.}\)</span> We deduce that <span class="process-math">\(f(y)-f(x) = \int_x^y f'\text{.}\)</span></article></details>
</div></details></div></article><article class="task exercise-like"><h5 class="heading"><span class="codenumber">(c)</span></h5>Using the fundamental theorem of calculus, state and prove  the integration by parts formula.<div class="solutions"><details class="solution solution-like"><summary><span class="type">Solution</span><span class="period">.</span></summary><div class="solution solution-like">
<article class="corollary theorem-like"><h6 class="heading">
<span class="type">Corollary</span><span class="space"> </span><span class="codenumber">10.7</span><span class="period">.</span><span class="space"> </span><span class="title">Integration by parts.</span>
</h6>Let <span class="process-math">\(f ,g: (a,b) \to \R\text{.}\)</span> Suppose that <span class="process-math">\(f\)</span> and <span class="process-math">\(g\)</span> are differentiable on <span class="process-math">\((a,b)\text{.}\)</span> Given <span class="process-math">\(x,y \in (a,b)\)</span> with <span class="process-math">\(x \lt  y\text{,}\)</span> suppose that both <span class="process-math">\(f'\)</span> and <span class="process-math">\(g'\)</span> are Riemann integrable on <span class="process-math">\([x,y]\text{.}\)</span> Then<div class="displaymath process-math">
\begin{equation*}
\int_x^y f'g = f(y)g(y) - f(x)g(x) - \int_x^y fg'. 
\end{equation*}
</div></article><details class="hiddenproof"><summary><h6 class="heading"><span class="type">Proof<span class="period">.</span></span></h6></summary><article class="hiddenproof">By the product rule for differentiation (<a href="" class="xref" data-knowl="./knowl/prop-alg-diff.html" title="Proposition 7.10: Algebra of differentiation">Proposition 7.10</a>) we have <span class="process-math">\((fg)' = f'g + fg'\text{.}\)</span> Both <span class="process-math">\(f'g\)</span> and <span class="process-math">\(fg'\)</span> are integrable on <span class="process-math">\([x,y]\text{,}\)</span> as they are products of Riemann integrable functions (<code class="code-inline tex2jax_ignore">[cross-reference to target(s) "thm-int-mult" missing or not unique]</code>). Therefore <span class="process-math">\((fg)'\)</span> is also integrable on <span class="process-math">\([x,y]\text{,}\)</span> by linearity of integration (<a href="" class="xref" data-knowl="./knowl/thm-int-add.html" title="Theorem 9.13: Linearity of integration">Theorem 9.13</a>). Hence by the fundamental theorem of calculus (<a href="" class="xref" data-knowl="./knowl/thm-ftc-int-of-deriv.html" title="Theorem 10.6: Fundamental theorem of calculus - integral of derivative">Theorem 10.6</a>), we have<div class="displaymath process-math" data-contains-math-knowls="./knowl/prop-alg-diff.html  ./knowl/thm-int-add.html ./knowl/thm-ftc-int-of-deriv.html ./knowl/thm-int-add.html">
\begin{equation*}
\int_x^y \brac{f'g + fg'} = \int_x^y \brac{fg}' = f(y)g(y) - f(x)g(x).
\end{equation*}
</div>The result now follows from linearity of integration (<a href="" class="xref" data-knowl="./knowl/thm-int-add.html" title="Theorem 9.13: Linearity of integration">Theorem 9.13</a>).</article></details>
</div></details></div></article><article class="task exercise-like"><h5 class="heading"><span class="codenumber">(d)</span></h5>Using the fundamental theorem of calculus, state and prove  the change of variables formula, also known as integration by substitution.<div class="solutions"><details class="solution solution-like"><summary><span class="type">Solution</span><span class="period">.</span></summary><div class="solution solution-like">
<article class="corollary theorem-like"><h6 class="heading">
<span class="type">Corollary</span><span class="space"> </span><span class="codenumber">10.8</span><span class="period">.</span>
</h6>Change of variables formula<a class="xref" id="fn-16" href="" data-knowl="./knowl/fn-16.html" title="Footnote 10.2"><sup> 2 </sup></a>Let <span class="process-math">\(\phi: (a,b) \to (c,d)\)</span> be a differentiable function with continuous derivative <span class="process-math">\(\phi'\text{.}\)</span> Let <span class="process-math">\(f : (c,d) \to \R\)</span> be continuous. Given <span class="process-math">\(x,y \in (a,b)\)</span> we have<a class="xref" id="fn-17" href="" data-knowl="./knowl/fn-17.html" title="Footnote 10.3"><sup> 3 </sup></a><div class="displaymath process-math">
\begin{equation*}
\int_{\phi(x)}^{\phi(y)} f = \int_x^y \brac{f\circ \phi} \phi'.
\end{equation*}
</div></article><details class="hiddenproof"><summary><h6 class="heading"><span class="type">Proof<span class="period">.</span></span></h6></summary><article class="hiddenproof">The function <span class="process-math">\(f\circ \phi\)</span> is integrable on any closed interval in <span class="process-math">\((a,b)\text{,}\)</span> since the composition of continuous functions is continuous (<code class="code-inline tex2jax_ignore">[cross-reference to target(s) "prop-comp-cts" missing or not unique]</code>). Hence the function <span class="process-math">\((f\circ \phi)\phi'\)</span> is integrable on any closed interval in <span class="process-math">\((a,b)\text{,}\)</span> as it is the product of Riemann integrable functions (<code class="code-inline tex2jax_ignore">[cross-reference to target(s) "thm-int-mult" missing or not unique]</code>). Define the functions<div class="displaymath process-math" data-contains-math-knowls="  ./knowl/thm-ftc-deriv-of-int.html ./knowl/thm-chain-rule.html ./knowl/cor-mono-diff.html">
\begin{equation*}
F(s):=\int_{\phi(x)}^{s} f \quad\text{and}\quad G(t) :=\int_x^t \brac{f\circ \phi}\phi'.
\end{equation*}
</div>We would like to show that <span class="process-math">\(F(\phi(y)) = G(y)\text{.}\)</span> By the fundamental theorem of calculus (<a href="" class="xref" data-knowl="./knowl/thm-ftc-deriv-of-int.html" title="Theorem 10.5: Fundamental theorem of calculus - derivative of integral">Theorem 10.5</a>)  we have<div class="displaymath process-math" data-contains-math-knowls="  ./knowl/thm-ftc-deriv-of-int.html ./knowl/thm-chain-rule.html ./knowl/cor-mono-diff.html">
\begin{equation*}
F'(s) = f(s) \quad \text{and} \quad  G'(t) = f(\phi(t))\phi'(t).
\end{equation*}
</div>By the chain rule (<a href="" class="xref" data-knowl="./knowl/thm-chain-rule.html" title="Theorem 7.12: Chain rule">Theorem 7.12</a>) we have<div class="displaymath process-math" data-contains-math-knowls="  ./knowl/thm-ftc-deriv-of-int.html ./knowl/thm-chain-rule.html ./knowl/cor-mono-diff.html">
\begin{equation*}
(F\circ\phi)'(t) = f(\phi(t))\phi'(t).
\end{equation*}
</div>Since functions on an interval with zero derivative are constant (<a href="" class="xref" data-knowl="./knowl/cor-mono-diff.html" title="Corollary 8.9">Corollary 8.9</a>) there exists <span class="process-math">\(C \in \R\)</span> such that for all <span class="process-math">\(t\in (a,b)\)</span> we have<div class="displaymath process-math" data-contains-math-knowls="  ./knowl/thm-ftc-deriv-of-int.html ./knowl/thm-chain-rule.html ./knowl/cor-mono-diff.html">
\begin{equation*}
(F\circ\phi)(t)-G(t) = C.
\end{equation*}
</div>Since <span class="process-math">\((F\circ \phi) (x) = 0\)</span> and <span class="process-math">\(G(x) = 0\text{,}\)</span> we deduce that <span class="process-math">\(C = 0\text{.}\)</span> The required identity follows.</article></details>
</div></details></div></article></article><span class="incontext"><a class="internal" href="week-10.html#exercise-81">in-context</a></span>
</body>
</html>
